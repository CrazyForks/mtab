import{r as e,u as l,b as a,c as t,d as o,e as u,k as d,h as r,X as n,L as i,F as s,f as p,g as c,a1 as m,p as v,x as g,m as h,j as f,V as b,a2 as w}from"./index.1705848582155.js";const V={class:"linkstoreAdmin"},_={class:"p-4 bg-white rounded-lg overflow-hidden flex flex-wrap gap-4"},y={class:"ml-auto"},k={class:"mt-4 p-4 bg-white rounded-lg overflow-hidden w-full"},x=["src"],C={style:{display:"flex","align-items":"center",width:"100%"}},U=["src"],z={class:"bgColorPicker"},j=["onClick"],S={key:0,class:"touming"},O={key:0,style:{"font-size":"20px",color:"#ff0000",inset:"-5px 3px",position:"relative"}},F={key:0,style:{"font-size":"20px",color:"#d9d9d9",inset:"-5px 3px",position:"relative"}},L={class:"folderManager"},A={class:"flex w-full mt-6"},D={class:"flex mt-6"},I={__name:"linkstore",setup(I){const P={id:"",name:"",sort:""},E=e(Object.assign({},P)),M=e([]),W=["rgba(0,0,0,0)","#fff","rgb(22, 129, 255)","rgb(251, 190, 35)","rgb(252, 69, 72)","rgb(75, 60, 54)","rgb(125, 172, 104)","rgb(2, 51, 115)","rgb(200, 172, 112)","rgb(55, 33, 40)","rgb(5, 64, 146)"],G=()=>{n({url:"/linkStore/getFolder"}).then((e=>{M.value=e.data}))};G();const R=e({name:"",area:""}),X=()=>{i.success("还未建设完成，请耐心等待！")},$=(e="")=>{if(e){e=e.split(",");const l=[];return e.forEach((e=>{const a=M.value.find((l=>l.id.toString()===e));a&&l.push(a.name)})),l.join(",")}return""},q=e(!1),B=e(!1),H=l(),J=e(!1),K=e({}),N=()=>{K.value={},J.value=!0},Q=()=>{B.value=!0},T=(e={})=>{E.value=0===e?Object.assign({},P):Object.assign({},e),q.value=!0},Y=()=>{n({url:"/linkStore/createFolder",method:"post",data:{type:"edit",info:E.value}}).then((e=>{i.success(e.msg),1===e.code&&(G(),q.value=!1)}))},Z=e=>{1===e.code&&(K.value.src=e.data.url)};let ee=e(!1);const le=async()=>{ee.value=!0;try{const e=await n({url:"/api/getIcon",method:"post",data:{url:K.value.url}});1===e.code?(K.value.src=e.data.src,K.value.tips=e.data.name.substring(0,30)):i.error("获取网站数据失败,请手动设置")}catch(e){console.error("Error fetching data:",e),i.error("获取网站数据失败,请手动设置")}ee.value=!1},ae=()=>{let e=Object.assign({},K.value);e.area&&(e.area=e.area.join(",")),n({url:"/linkStore/add",method:"post",data:{form:e}}).then((e=>{i.success(e.msg),J.value=!1,de()}))},te=e({current_page:1,per_page:50,total:0,refresh(e){te.value.current_page=e,de()},sizes(e){te.value.per_page=e,de()}}),oe=e([]),ue={order:"desc",prop:"id"},de=()=>{n({url:"/LinkStore/ListManager",method:"post",data:{search:R.value,page:te.value.current_page,limit:te.value.per_page,sort:ue}}).then((e=>{oe.value=e.data.data,Object.assign(te.value,e.data)}))},re=({column:e,prop:l,order:a})=>{let t="asc";"descending"===a&&(t="desc"),ue.order=t,ue.prop=l,de()};return de(),(e,l)=>{const I=a("el-input"),P=a("el-option"),ee=a("el-select"),ue=a("el-button"),ne=a("el-table-column"),ie=a("el-tag"),se=a("el-table"),pe=a("el-pagination"),ce=a("el-form-item"),me=a("el-upload"),ve=a("el-switch"),ge=a("el-color-picker"),he=a("el-input-number"),fe=a("el-form"),be=a("el-dialog");return t(),o("div",V,[u("div",_,[d(I,{modelValue:R.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>R.value.name=e),style:{width:"200px"},placeholder:"名称搜索",clearable:""},null,8,["modelValue"]),d(ee,{modelValue:R.value.area,"onUpdate:modelValue":l[1]||(l[1]=e=>R.value.area=e),style:{width:"200px"},placeholder:"分类搜索",clearable:""},{default:r((()=>[(t(!0),o(s,null,p(M.value,(e=>(t(),c(P,{value:e.id,label:e.name},null,8,["value","label"])))),256))])),_:1},8,["modelValue"]),d(ue,{onClick:de,type:"primary"},{default:r((()=>[m("搜索")])),_:1}),d(ue,{type:"danger",onClick:N},{default:r((()=>[m("添加新标签")])),_:1}),d(ue,{style:{background:"lightseagreen",color:"#F3F3F3","margin-left":"100px"},round:"",onClick:X},{default:r((()=>[m(" 公共标签库 ")])),_:1}),u("div",y,[d(ue,{type:"info",onClick:Q},{default:r((()=>[m("标签分类管理")])),_:1})])]),u("div",k,[d(se,{onSortChange:re,height:"calc(100vh - 203px)",stripe:"",data:oe.value},{default:r((()=>[d(ne,{fixed:"left",sortable:"custom",prop:"id",label:"ID",align:"center",width:"100"}),d(ne,{prop:"name",label:"网站名称",sortable:"custom",align:"center",width:"200"}),d(ne,{prop:"src",label:"LOGO",align:"center",width:"80"},{default:r((e=>[u("img",{style:v([{backgroundColor:e.row.bgColor},{"max-width":"100%","max-height":"100%"}]),src:e.row.src,class:"logoiconRadius",alt:"Logo"},null,12,x)])),_:1}),d(ne,{prop:"url","show-overflow-tooltip":"",label:"域名链接",align:"center",width:"260"}),d(ne,{prop:"domain",label:"Domain",align:"center",width:"260"}),d(ne,{prop:"app",label:"是否WebApp",align:"center",width:"140"},{default:r((e=>[1===e.row.app?(t(),c(ie,{key:0},{default:r((()=>[m("WebApp")])),_:1})):(t(),c(ie,{key:1,type:"info"},{default:r((()=>[m("标签")])),_:1}))])),_:1}),d(ne,{prop:"area",width:"200px","show-overflow-tooltip":"",label:"分类",align:"center"},{default:r((e=>[m(g($(e.row.area)),1)])),_:1}),d(ne,{prop:"tips",label:"简介",align:"center",width:"300"}),d(ne,{sortable:"custom",prop:"install_num",label:"安装量(次)",align:"center",width:"150"}),d(ne,{prop:"create_time",sortable:"custom",label:"创建时间",align:"center",width:"200"}),d(ne,{fixed:"right",label:"操作",align:"center",width:"150"},{default:r((e=>[d(ue,{type:"primary",size:"small",onClick:l=>(e=>{K.value=Object.assign({},e);const l=e.area.split(",");l.length>0&&""!==l[0]?K.value.area=l:K.value.area=[],J.value=!0})(e.row)},{default:r((()=>[m("操作")])),_:2},1032,["onClick"]),d(ue,{type:"danger",size:"small",onClick:l=>{return a=e.row.id,void w.confirm("是否删除该标签？","删除提示").then((e=>{n({url:"/linkStore/del",method:"post",data:{ids:[a]}}).then((e=>{i.success(e.msg),de()}))})).catch();var a}},{default:r((()=>[m("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d(pe,{"page-size":te.value.per_page,onSizeChange:te.value.sizes,onCurrentChange:te.value.refresh,"page-sizes":[15,20,30,40,50,100],class:"mt-6",layout:"sizes,total,prev,pager,jumper",total:te.value.total},null,8,["page-size","onSizeChange","onCurrentChange","total"])]),d(be,{modelValue:J.value,"onUpdate:modelValue":l[13]||(l[13]=e=>J.value=e),title:"编辑标签",size:"400px","close-on-click-modal":!1,top:"5vh"},{default:r((()=>[d(fe,{modelValue:K.value,"onUpdate:modelValue":l[12]||(l[12]=e=>K.value=e),"label-position":"top"},{default:r((()=>[d(ce,{label:"名称"},{default:r((()=>[d(I,{modelValue:K.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>K.value.name=e),"show-word-limit":"",maxlength:"50",placeholder:"请输入网站title或名称"},null,8,["modelValue"])])),_:1}),d(ce,{label:"网址"},{default:r((()=>[d(I,{modelValue:K.value.url,"onUpdate:modelValue":l[3]||(l[3]=e=>K.value.url=e),"show-word-limit":"",maxlength:"251",placeholder:"请输入网址,请携带http协议"},null,8,["modelValue"])])),_:1}),d(ce,{label:"logo"},{default:r((()=>[u("div",C,[K.value.src?(t(),o("img",{key:0,src:K.value.src,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,U)):h("",!0),d(I,{modelValue:K.value.src,"onUpdate:modelValue":l[4]||(l[4]=e=>K.value.src=e),placeholder:"标签图标地址(120x120)px尺寸最佳"},{append:r((()=>[d(me,{class:"upload-demo","show-file-list":!1,"on-success":Z,action:f(b)+f(H).state.site.upload},{default:r((()=>[d(ue,{type:"primary"},{default:r((()=>[m("上传")])),_:1})])),_:1},8,["action"])])),_:1},8,["modelValue"]),d(ue,{type:"primary",style:{width:"100px","margin-left":"15px"},onClick:le},{default:r((()=>[m("抓取图标")])),_:1})])])),_:1}),d(ce,{label:"域名"},{default:r((()=>[d(I,{modelValue:K.value.domain,"onUpdate:modelValue":l[5]||(l[5]=e=>K.value.domain=e),"show-word-limit":"",maxlength:"251",placeholder:"请输入域名多个可以用,隔开。域名不要携带http协议"},null,8,["modelValue"])])),_:1}),d(ce,{label:"分类"},{default:r((()=>[d(ee,{modelValue:K.value.area,"onUpdate:modelValue":l[6]||(l[6]=e=>K.value.area=e),multiple:!0,placeholder:"分类选择可多选",class:"w-full"},{default:r((()=>[(t(!0),o(s,null,p(M.value,(e=>(t(),c(P,{key:e.id,label:e.name,value:`${e.id}`},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(ce,{label:"简介"},{default:r((()=>[d(I,{modelValue:K.value.tips,"onUpdate:modelValue":l[7]||(l[7]=e=>K.value.tips=e),placeholder:"请简单介绍一下建议30字符以内","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])])),_:1}),d(ce,{label:"是否网页APP"},{default:r((()=>[d(ve,{"active-value":1,"inactive-value":0,modelValue:K.value.app,"onUpdate:modelValue":l[8]||(l[8]=e=>K.value.app=e)},null,8,["modelValue"])])),_:1}),d(ce,{label:"背景颜色"},{default:r((()=>[u("ul",z,[(t(),o(s,null,p(W,(e=>u("li",{onClick:l=>{return a=e,void(K.value.bgColor=a);var a}},["rgba(0,0,0,0)"===e?(t(),o("div",S,[e===K.value.bgColor?(t(),o("b",O,"√")):h("",!0)])):(t(),o("div",{key:1,style:v({backgroundColor:e})},[e===K.value.bgColor?(t(),o("b",F,"√")):h("",!0)],4))],8,j))),64))]),d(ge,{"show-alpha":"",modelValue:K.value.bgColor,"onUpdate:modelValue":l[9]||(l[9]=e=>K.value.bgColor=e)},null,8,["modelValue"])])),_:1}),d(ce,{label:"标签添加量（热度）"},{default:r((()=>[d(he,{modelValue:K.value.install_num,"onUpdate:modelValue":l[10]||(l[10]=e=>K.value.install_num=e),class:"w-full",placeholder:"数值越高排名越高"},null,8,["modelValue"])])),_:1}),d(ce,{label:"排行"},{default:r((()=>[d(he,{modelValue:K.value.hot,"onUpdate:modelValue":l[11]||(l[11]=e=>K.value.hot=e),class:"w-full",placeholder:"数值越高排名越高"},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),d(ue,{type:"primary",class:"w-full",onClick:ae},{default:r((()=>[m("保存")])),_:1})])),_:1},8,["modelValue"]),d(be,{modelValue:B.value,"onUpdate:modelValue":l[19]||(l[19]=e=>B.value=e),width:"1000px",title:"分类管理","close-on-click-modal":!1},{default:r((()=>[u("div",L,[d(se,{border:"",data:M.value,style:{width:"100%"},height:"450"},{default:r((()=>[d(ne,{prop:"id",fixed:"",label:"分类ID",width:"90",align:"center"}),d(ne,{prop:"name",label:"分类名称"}),d(ne,{prop:"sort",sortable:"",align:"center",width:"120",label:"分类排序"}),d(ne,{fixed:"right",label:"操作",align:"center",width:"150"},{default:r((e=>[d(ue,{type:"success",size:"small",onClick:l=>T(e.row)},{default:r((()=>[m("修改")])),_:2},1032,["onClick"]),d(ue,{type:"danger",size:"small",onClick:l=>{return a=e.row,void w.confirm("是否删除当前标签分类","危险警告").then((e=>{n({url:"/linkStore/createFolder",method:"post",data:{type:"del",id:a.id}}).then((e=>{i.success(e.msg),1===e.code&&(G(),q.value=!1)}))}));var a}},{default:r((()=>[m("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u("div",A,[d(ue,{type:"primary",class:"m-auto w-1/5",onClick:l[14]||(l[14]=e=>T(0))},{default:r((()=>[m("新增")])),_:1})]),d(be,{modelValue:q.value,"onUpdate:modelValue":l[18]||(l[18]=e=>q.value=e),width:"500px","align-center":"","append-to-body":"",title:"分类编辑"},{default:r((()=>[d(fe,{modelValue:K.value,"onUpdate:modelValue":l[17]||(l[17]=e=>K.value=e),"label-position":"top"},{default:r((()=>[d(ce,{label:"分类名称"},{default:r((()=>[d(I,{modelValue:E.value.name,"onUpdate:modelValue":l[15]||(l[15]=e=>E.value.name=e),"show-word-limit":"",maxlength:"50",placeholder:"请输入分类名称"},null,8,["modelValue"])])),_:1}),d(ce,{label:"分类排序"},{default:r((()=>[d(he,{modelValue:E.value.sort,"onUpdate:modelValue":l[16]||(l[16]=e=>E.value.sort=e),class:"w-full",placeholder:"请输入展示排序（值越大越靠前）"},null,8,["modelValue"])])),_:1}),u("div",D,[d(ue,{class:"m-auto w-2/5",type:"primary",onClick:Y},{default:r((()=>[m("保存")])),_:1})])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])])}}};export{I as default};
