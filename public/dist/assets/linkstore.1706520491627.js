import{r as e,u as l,b as a,c as t,d as o,e as u,k as d,h as r,j as n,ab as i,g as s,m as p,X as c,L as m,ac as v,ad as g,a2 as h,F as f,f as b,a1 as w,p as V,x as _,V as y}from"./index.1706520491627.js";const k={class:"linkstoreAdmin"},x={class:"p-4 bg-white rounded-lg overflow-hidden flex flex-wrap gap-4"},C={class:"ml-auto"},U={class:"mt-4 p-4 bg-white rounded-lg overflow-hidden w-full"},z=["src"],j={style:{display:"flex","align-items":"center",width:"100%"}},S=["src"],F={class:"bgColorPicker"},O=["onClick"],L={key:0,class:"touming"},A={key:0,style:{"font-size":"20px",color:"#ff0000",inset:"-5px 3px",position:"relative"}},E={key:0,style:{"font-size":"20px",color:"#d9d9d9",inset:"-5px 3px",position:"relative"}},D={class:"folderManager"},I={class:"flex w-full mt-6"},P={class:"flex mt-6"},M={__name:"linkstore",setup(M){const R=e(),W=e([]),G=e=>{W.value=e},T={id:"",name:"",sort:""},X=e(Object.assign({},T)),$=e([]),q=["rgba(0,0,0,0)","#fff","rgb(22, 129, 255)","rgb(251, 190, 35)","rgb(252, 69, 72)","rgb(75, 60, 54)","rgb(125, 172, 104)","rgb(2, 51, 115)","rgb(200, 172, 112)","rgb(55, 33, 40)","rgb(5, 64, 146)"],B=()=>{c({url:"/linkStore/getFolder"}).then((e=>{$.value=e.data}))};B();const H=e({name:"",area:""}),J=()=>{m.success("还未建设完成，请耐心等待！")},K=(e="")=>{if(e){e=e.split(",");const l=[];return e.forEach((e=>{const a=$.value.find((l=>l.id.toString()===e));a&&l.push(a.name)})),l.join(",")}return""},N=e(!1),Q=e(!1),Y=l(),Z=e(!1),ee=e({}),le=()=>{ee.value={},Z.value=!0},ae=()=>{Q.value=!0},te=(e={})=>{X.value=0===e?Object.assign({},T):Object.assign({},e),N.value=!0},oe=()=>{c({url:"/linkStore/createFolder",method:"post",data:{type:"edit",info:X.value}}).then((e=>{m.success(e.msg),1===e.code&&(B(),N.value=!1)}))},ue=e=>{h.confirm("是否删除选中的标签？","删除提示").then((l=>{c({url:"/linkStore/del",method:"post",data:{ids:"object"==typeof e?e:[e]}}).then((e=>{m.success(e.msg),ge()}))})).catch((()=>{m.warning("已取消操作")}))},de=()=>{if(W.value.length>0){let e=[];W.value.forEach((l=>{e.push(l.id)})),ue(e)}},re=()=>{const l=e([]);let a=[];$.value.forEach((e=>{a.push(v(g,{label:e.name,value:e.id}))})),h({title:"请选择移动的分类","close-on-click-modal":!1,draggable:!0,message:()=>v(i,{modelValue:l.value,multiple:!0,placeholder:"请选择移动的分类可多选",class:"w-full","onUpdate:modelValue":e=>{l.value=e}},(()=>a))}).then((e=>{let a={link:W.value.map((e=>e.id)),area:l.value.join(",")};c({url:"/linkstore/moveFolder",method:"post",data:a}).then((e=>{ge(),m.success(e.msg)}))})).catch((e=>{m.warning("已取消操作")}))},ne=e=>{1===e.code&&(ee.value.src=e.data.url)};let ie=e(!1);const se=async()=>{ie.value=!0;try{const e=await c({url:"/api/getIcon",method:"post",data:{url:ee.value.url}});1===e.code?(ee.value.src=e.data.src,ee.value.tips=e.data.name.substring(0,30)):m.error("获取网站数据失败,请手动设置")}catch(e){console.error("Error fetching data:",e),m.error("获取网站数据失败,请手动设置")}ie.value=!1},pe=()=>{let e=Object.assign({},ee.value);e.area&&(e.area=e.area.join(",")),c({url:"/linkStore/add",method:"post",data:{form:e}}).then((e=>{m.success(e.msg),Z.value=!1,ge()}))},ce=e({current_page:1,per_page:50,total:0,refresh(e){ce.value.current_page=e,ge()},sizes(e){ce.value.per_page=e,ge()}}),me=e([]),ve={order:"desc",prop:"id"},ge=()=>{c({url:"/LinkStore/ListManager",method:"post",data:{search:H.value,page:ce.value.current_page,limit:ce.value.per_page,sort:ve}}).then((e=>{me.value=e.data.data,Object.assign(ce.value,e.data)}))},he=({column:e,prop:l,order:a})=>{let t="asc";"descending"===a&&(t="desc"),ve.order=t,ve.prop=l,ge()};return ge(),(e,l)=>{const v=a("el-input"),M=a("el-button"),T=a("el-table-column"),ie=a("el-tag"),ve=a("el-table"),fe=a("el-pagination"),be=a("el-form-item"),we=a("el-upload"),Ve=a("el-switch"),_e=a("el-color-picker"),ye=a("el-input-number"),ke=a("el-form"),xe=a("el-dialog");return t(),o("div",k,[u("div",x,[d(v,{modelValue:H.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>H.value.name=e),style:{width:"200px"},placeholder:"名称搜索",clearable:""},null,8,["modelValue"]),d(n(i),{modelValue:H.value.area,"onUpdate:modelValue":l[1]||(l[1]=e=>H.value.area=e),style:{width:"200px"},placeholder:"分类搜索",clearable:""},{default:r((()=>[(t(!0),o(f,null,b($.value,(e=>(t(),s(n(g),{value:e.id,label:e.name},null,8,["value","label"])))),256))])),_:1},8,["modelValue"]),d(M,{onClick:ge,type:"primary"},{default:r((()=>[w("搜索")])),_:1}),d(M,{type:"danger",onClick:le},{default:r((()=>[w("添加新标签")])),_:1}),d(M,{style:{background:"lightseagreen",color:"#F3F3F3"},round:"",onClick:J},{default:r((()=>[w(" 公共标签库 ")])),_:1}),u("div",C,[W.value.length>0?(t(),s(M,{key:0,type:"danger",onClick:de,round:""},{default:r((()=>[w("批量删除")])),_:1})):p("",!0),W.value.length>0?(t(),s(M,{key:1,type:"primary",onClick:re,round:""},{default:r((()=>[w("批量分类")])),_:1})):p("",!0),d(M,{type:"info",onClick:ae},{default:r((()=>[w("标签分类管理")])),_:1})])]),u("div",U,[d(ve,{onSelectionChange:G,ref_key:"multipleTableRef",ref:R,onSortChange:he,height:"calc(100vh - 203px)",stripe:"",data:me.value},{default:r((()=>[d(T,{type:"selection",width:"30",align:"center"}),d(T,{fixed:"left",sortable:"custom",prop:"id",label:"ID",align:"center",width:"100"}),d(T,{prop:"name",label:"网站名称",sortable:"custom",align:"center",width:"200"}),d(T,{prop:"src",label:"LOGO",align:"center",width:"80"},{default:r((e=>[u("img",{style:V([{backgroundColor:e.row.bgColor},{"max-width":"100%","max-height":"100%"}]),src:e.row.src,class:"logoiconRadius",alt:"Logo"},null,12,z)])),_:1}),d(T,{prop:"url","show-overflow-tooltip":"",label:"域名链接",align:"center",width:"260"}),d(T,{prop:"domain",label:"Domain",align:"center",width:"260"}),d(T,{prop:"app",label:"是否WebApp",align:"center",width:"140"},{default:r((e=>[1===e.row.app?(t(),s(ie,{key:0},{default:r((()=>[w("WebApp")])),_:1})):(t(),s(ie,{key:1,type:"info"},{default:r((()=>[w("标签")])),_:1}))])),_:1}),d(T,{prop:"area",width:"200px","show-overflow-tooltip":"",label:"分类",align:"center"},{default:r((e=>[w(_(K(e.row.area)),1)])),_:1}),d(T,{prop:"tips",label:"简介",align:"center",width:"300"}),d(T,{sortable:"custom",prop:"install_num",label:"安装量(次)",align:"center",width:"150"}),d(T,{prop:"create_time",sortable:"custom",label:"创建时间",align:"center",width:"200"}),d(T,{fixed:"right",label:"操作",align:"center",width:"150"},{default:r((e=>[d(M,{type:"primary",size:"small",onClick:l=>(e=>{ee.value=Object.assign({},e);const l=e.area.split(",");l.length>0&&""!==l[0]?ee.value.area=l:ee.value.area=[],Z.value=!0})(e.row)},{default:r((()=>[w("操作")])),_:2},1032,["onClick"]),d(M,{type:"danger",size:"small",onClick:l=>ue(e.row.id)},{default:r((()=>[w("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d(fe,{"page-size":ce.value.per_page,onSizeChange:ce.value.sizes,onCurrentChange:ce.value.refresh,"page-sizes":[15,20,30,40,50,100],class:"mt-6",layout:"sizes,total,prev,pager,jumper",total:ce.value.total},null,8,["page-size","onSizeChange","onCurrentChange","total"])]),d(xe,{modelValue:Z.value,"onUpdate:modelValue":l[13]||(l[13]=e=>Z.value=e),title:"编辑标签",size:"400px","close-on-click-modal":!1,top:"5vh"},{default:r((()=>[d(ke,{modelValue:ee.value,"onUpdate:modelValue":l[12]||(l[12]=e=>ee.value=e),"label-position":"top"},{default:r((()=>[d(be,{label:"名称"},{default:r((()=>[d(v,{modelValue:ee.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>ee.value.name=e),"show-word-limit":"",maxlength:"50",placeholder:"请输入网站title或名称"},null,8,["modelValue"])])),_:1}),d(be,{label:"网址"},{default:r((()=>[d(v,{modelValue:ee.value.url,"onUpdate:modelValue":l[3]||(l[3]=e=>ee.value.url=e),"show-word-limit":"",maxlength:"251",placeholder:"请输入网址,请携带http协议"},null,8,["modelValue"])])),_:1}),d(be,{label:"logo"},{default:r((()=>[u("div",j,[ee.value.src?(t(),o("img",{key:0,src:ee.value.src,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,S)):p("",!0),d(v,{modelValue:ee.value.src,"onUpdate:modelValue":l[4]||(l[4]=e=>ee.value.src=e),placeholder:"标签图标地址(120x120)px尺寸最佳"},{append:r((()=>[d(we,{class:"upload-demo","show-file-list":!1,"on-success":ne,action:n(y)+n(Y).state.site.upload},{default:r((()=>[d(M,{type:"primary"},{default:r((()=>[w("上传")])),_:1})])),_:1},8,["action"])])),_:1},8,["modelValue"]),d(M,{type:"primary",style:{width:"100px","margin-left":"15px"},onClick:se},{default:r((()=>[w("抓取图标")])),_:1})])])),_:1}),d(be,{label:"域名"},{default:r((()=>[d(v,{modelValue:ee.value.domain,"onUpdate:modelValue":l[5]||(l[5]=e=>ee.value.domain=e),"show-word-limit":"",maxlength:"251",placeholder:"请输入域名多个可以用,隔开。域名不要携带http协议"},null,8,["modelValue"])])),_:1}),d(be,{label:"分类"},{default:r((()=>[d(n(i),{modelValue:ee.value.area,"onUpdate:modelValue":l[6]||(l[6]=e=>ee.value.area=e),multiple:!0,placeholder:"分类选择可多选",class:"w-full"},{default:r((()=>[(t(!0),o(f,null,b($.value,(e=>(t(),s(n(g),{key:e.id,label:e.name,value:`${e.id}`},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(be,{label:"简介"},{default:r((()=>[d(v,{modelValue:ee.value.tips,"onUpdate:modelValue":l[7]||(l[7]=e=>ee.value.tips=e),placeholder:"请简单介绍一下建议30字符以内","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])])),_:1}),d(be,{label:"是否网页APP"},{default:r((()=>[d(Ve,{"active-value":1,"inactive-value":0,modelValue:ee.value.app,"onUpdate:modelValue":l[8]||(l[8]=e=>ee.value.app=e)},null,8,["modelValue"])])),_:1}),d(be,{label:"背景颜色"},{default:r((()=>[u("ul",F,[(t(),o(f,null,b(q,(e=>u("li",{onClick:l=>{return a=e,void(ee.value.bgColor=a);var a}},["rgba(0,0,0,0)"===e?(t(),o("div",L,[e===ee.value.bgColor?(t(),o("b",A,"√")):p("",!0)])):(t(),o("div",{key:1,style:V({backgroundColor:e})},[e===ee.value.bgColor?(t(),o("b",E,"√")):p("",!0)],4))],8,O))),64))]),d(_e,{"show-alpha":"",modelValue:ee.value.bgColor,"onUpdate:modelValue":l[9]||(l[9]=e=>ee.value.bgColor=e)},null,8,["modelValue"])])),_:1}),d(be,{label:"标签添加量（热度）"},{default:r((()=>[d(ye,{modelValue:ee.value.install_num,"onUpdate:modelValue":l[10]||(l[10]=e=>ee.value.install_num=e),class:"w-full",placeholder:"数值越高排名越高"},null,8,["modelValue"])])),_:1}),d(be,{label:"排行"},{default:r((()=>[d(ye,{modelValue:ee.value.hot,"onUpdate:modelValue":l[11]||(l[11]=e=>ee.value.hot=e),class:"w-full",placeholder:"数值越高排名越高"},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),d(M,{type:"primary",class:"w-full",onClick:pe},{default:r((()=>[w("保存")])),_:1})])),_:1},8,["modelValue"]),d(xe,{modelValue:Q.value,"onUpdate:modelValue":l[19]||(l[19]=e=>Q.value=e),width:"1000px",title:"分类管理","close-on-click-modal":!1},{default:r((()=>[u("div",D,[d(ve,{border:"",data:$.value,style:{width:"100%"},height:"450"},{default:r((()=>[d(T,{prop:"id",fixed:"",label:"分类ID",width:"90",align:"center"}),d(T,{prop:"name",label:"分类名称"}),d(T,{prop:"sort",sortable:"",align:"center",width:"120",label:"分类排序"}),d(T,{fixed:"right",label:"操作",align:"center",width:"150"},{default:r((e=>[d(M,{type:"success",size:"small",onClick:l=>te(e.row)},{default:r((()=>[w("修改")])),_:2},1032,["onClick"]),d(M,{type:"danger",size:"small",onClick:l=>{return a=e.row,void h.confirm("是否删除当前标签分类","危险警告").then((e=>{c({url:"/linkStore/createFolder",method:"post",data:{type:"del",id:a.id}}).then((e=>{m.success(e.msg),1===e.code&&(B(),N.value=!1)}))}));var a}},{default:r((()=>[w("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u("div",I,[d(M,{type:"primary",class:"m-auto w-1/5",onClick:l[14]||(l[14]=e=>te(0))},{default:r((()=>[w("新增")])),_:1})]),d(xe,{modelValue:N.value,"onUpdate:modelValue":l[18]||(l[18]=e=>N.value=e),width:"500px","align-center":"","append-to-body":"",title:"分类编辑"},{default:r((()=>[d(ke,{modelValue:ee.value,"onUpdate:modelValue":l[17]||(l[17]=e=>ee.value=e),"label-position":"top"},{default:r((()=>[d(be,{label:"分类名称"},{default:r((()=>[d(v,{modelValue:X.value.name,"onUpdate:modelValue":l[15]||(l[15]=e=>X.value.name=e),"show-word-limit":"",maxlength:"50",placeholder:"请输入分类名称"},null,8,["modelValue"])])),_:1}),d(be,{label:"分类排序"},{default:r((()=>[d(ye,{modelValue:X.value.sort,"onUpdate:modelValue":l[16]||(l[16]=e=>X.value.sort=e),class:"w-full",placeholder:"请输入展示排序（值越大越靠前）"},null,8,["modelValue"])])),_:1}),u("div",P,[d(M,{class:"m-auto w-2/5",type:"primary",onClick:oe},{default:r((()=>[w("保存")])),_:1})])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])])}}};export{M as default};
