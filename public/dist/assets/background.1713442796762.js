import{u as e,r as l,a,b as t,K as d,c as s,d as u,i,e as o,F as r,f as n,v as c,k as p,h as v,Y as f,Z as m,H as g,g as b,n as h,x as y,j as x,al as _,l as w,a6 as k,ak as V,T as j,G as C,am as z,an as W,m as U,a3 as O}from"./index.1713442796762.js";import{S as B}from"./sortable.esm.1713442796762.js";const F={id:"backgroundManager",class:"rounded-lg overflow-hidden flex flex-wrap gap-2"},M={class:"flex flex-col bg-white w-52 px-2 py-4 rounded-lg h-full"},T={class:"h-full relative overflow-y-scroll leftScrollBackground"},E={class:"space-y-1 mb-4",id:"list"},S=["onClick","data-id"],A={class:"flex items-center"},I={class:"flex items-center gap-2"},D={class:"sticky bottom-0 flex justify-center"},G={class:"flex-1 relative overflow-y-scroll h-full"},H={class:"bg-white overflow-scroll relative flex-1 rounded-lg p-4"},K={class:"grid grid-cols-4 gap-4",style:{"grid-auto-rows":"max-content"}},Y={style:{"aspect-ratio":"16 / 9",background:"linear-gradient(to right bottom, #ff4f00, #ff9068, #fdbc45, #ff9068, #ff4f00)"},class:"relative rounded-lg cursor-pointer"},Z=o("div",{class:"el-upload__text"}," 点击这里上传您的背景资源 ",-1),q={style:{"aspect-ratio":"16 / 9"},class:"relative"},J=["src"],L={class:"absolute rounded-lg opacity-0 transition-all hover:opacity-100 inset-0 w-full h-full flex justify-center items-center",style:{"background-color":"rgba(0, 0, 0, 0.178)"}},N=["onClick"],P={class:"absolute z-10 right-0 bottom-0 w-full h-8 flex justify-end"},Q={class:"transition-all mr-4 cursor-pointer mr-2 hover:bg-blue-500 rounded-full w-6 mb-2 flex justify-center items-center"},R=["href"],X={class:"flex justify-center mt-8 mb-6"},$={style:{display:"flex","align-items":"center",width:"100%"}},ee=["src"],le=o("div",{class:"text-xs text-red-400 mt-1"},"建议文件尺寸不要大于5MB，过大请压缩后上传，推荐使用图床减轻服务器带宽压力",-1),ae={style:{display:"flex","align-items":"center",width:"100%"}},te=["src"],de=o("div",{class:"text-xs text-red-400 mt-1"},"建议文件尺寸不要大于5MB，过大请压缩后上传，推荐使用cdn+云储存减轻服务器带宽压力",-1),se={style:{display:"flex","align-items":"center",width:"100%"}},ue=["src"],ie=o("div",{class:"text-xs text-red-400 mt-1"},"图片尺寸宽度控制在300px左右或(文件大小在100kb左右)，推荐使用图床减轻服务器带宽压力",-1),oe={__name:"background",setup(oe){const re=e(),ne=l(!1);let ce=null;const pe={id:"",type:0,mime:0,cover:"",folder:0,url:"",name:""},ve=l(Object.assign({},pe)),fe=l(0),me=l([]),ge=l(!0),be=l(!0),he={data:[],current_page:1,per_page:19},ye=l(Object.assign({},he)),xe=e=>{fe.value=e.id,ye.value=Object.assign({},he),je()},_e=()=>{ve.value=Object.assign({},pe),ve.value.folder=fe.value,ne.value=!0},we=e=>{1===e.code&&(ve.value.url=e.data.url)},ke=e=>{1===e.code&&(ve.value.cover=e.data.url)},Ve=async()=>{if(ve.value.folder&&ve.value.cover&&ve.value.url){1===(await m({url:"/Wallpaper/addWallpaper",method:"post",data:ve.value})).code&&(je(),ne.value=!1)}},je=()=>{be.value=!0,m({url:"/Wallpaper/getFolderWallpaper",method:"post",data:{id:fe.value,limit:ye.value.per_page,page:ye.value.current_page}}).then((e=>{1===e.code&&(ye.value=e.data)})).finally((e=>{be.value=!1}))},Ce=(e,l)=>{"size"==e&&(ye.value.per_page=l),"page"==e&&(ye.value.current_page=l),je()},ze=e=>{let l="",a="";"add"!==e&&(l=e.id,a=e.name),f.prompt("请输入壁纸分类名称","编辑文件夹",{confirmButtonText:"提交",cancelButtonText:"取消",inputValue:a,inputValidator:e=>""!==e&&null!==e,inputErrorMessage:"请输入分类名称"}).then((({value:e})=>{ge.value=!0,m({url:"/Wallpaper/editFolder",method:"post",data:{id:l,name:e}}).then((e=>{1===e.code&&(me.value=e.data)})).finally((e=>{ge.value=!1}))})).catch((()=>{g.warning("已取消操作")}))};return m({url:"/Wallpaper/getFolder"}).then((e=>{1===e.code&&(me.value=e.data,me.value.length>0&&xe(me.value[0])),ge.value=!1})),a((()=>{let e=document.getElementById("list");if(e){const l={animation:200,delay:500,delayOnTouchOnly:!0,draggable:".item",onUpdate:function(e){let l=ce.toArray(),a=[];l.forEach(((e,l)=>{a.push({id:parseInt(e),sort:l})})),m({url:"/Wallpaper/sortFolder",method:"post",data:a}).then((e=>{e.code}))}};ce=B.create(e,l)}})),(e,l)=>{const a=t("el-icon"),g=t("el-button"),B=t("el-pagination"),oe=t("el-option"),ce=t("el-select"),pe=t("el-form-item"),he=t("el-upload"),We=t("el-input"),Ue=t("el-form"),Oe=t("el-dialog"),Be=d("loading");return s(),u("div",F,[i((s(),u("div",M,[o("div",T,[i(o("div",E,[(s(!0),u(r,null,n(me.value,(e=>(s(),b(j,{key:e.id},{default:v((()=>[o("div",{onClick:l=>xe(e),"data-id":null==e?void 0:e.id,class:h(["relative item px-4 py-1.5 text-sm rounded-sm cursor-pointer flex overflow-hidden justify-between items-center",{"bg-slate-200 text-blue-400":fe.value==e.id}])},[o("div",A,[o("span",null,y(e.name),1)]),o("div",I,[p(a,{class:"hover:text-blue-600",onClick:w((l=>ze(e)),["stop"])},{default:v((()=>[p(x(_))])),_:2},1032,["onClick"]),p(a,{class:"hover:text-blue-600",onClick:w((l=>(async e=>{try{await f.confirm("是否删除当前壁纸分类，删除后该目录下的壁纸将一并删除！","删除警告"),await f.confirm("您正在进行危险操作，您是否知晓当前正在删除的分类","二次确认")}catch(l){return!1}ge.value=!0,m({url:"/Wallpaper/DelFolder",method:"post",data:{id:e.id}}).then((e=>{1===e.code&&(me.value=e.data)})).finally((l=>{ge.value=!1,e.id==fe.value&&me.value.length>0&&xe(me.value[0])}))})(e)),["stop"])},{default:v((()=>[p(x(k))])),_:2},1032,["onClick"]),p(a,{class:"cursor-move"},{default:v((()=>[p(x(V))])),_:1})])],10,S)])),_:2},1024)))),128))],512),[[c,me.value.length]]),o("div",D,[p(g,{class:"w-11/12",type:"primary",onClick:l[0]||(l[0]=e=>ze("add"))},{default:v((()=>[C("创建分类")])),_:1})])])])),[[Be,ge.value]]),o("div",G,[i((s(),u("div",H,[o("div",K,[o("div",Y,[o("div",{onClick:_e,class:"upload-demo flex h-full flex-col justify-center items-center text-white"},[p(a,{size:"50px",class:"el-icon--upload"},{default:v((()=>[p(x(z))])),_:1}),Z])]),(s(!0),u(r,null,n(ye.value.data,(e=>(s(),b(j,{key:e.id},{default:v((()=>[o("div",q,[o("img",{class:"rounded-lg object-cover w-full h-full bg-gray-200",src:e.cover},null,8,J),o("div",L,[o("div",{onClick:l=>(e=>{ve.value=Object.assign({},e),ne.value=!0})(e),class:"transition-all cursor-pointer bg-black bg-opacity-40 hover:opacity-100 hover:bg-red-500 rounded-full flex justify-center items-center w-10 h-10"},[p(a,{size:"28px",color:"#fff"},{default:v((()=>[p(x(_))])),_:1})],8,N),o("div",P,[o("div",Q,[p(a,{onClick:l=>(async e=>{try{await f.confirm("是否删除当前选中壁纸？","删除警告")}catch(l){return!1}1===(await m({url:"/Wallpaper/deleteWallpaper",method:"post",data:{id:e.id}})).code&&(je(),ne.value=!1)})(e),size:"18px",color:"#fff"},{default:v((()=>[p(x(k))])),_:2},1032,["onClick"])]),o("a",{target:"_blank",download:"background",href:e.url,class:"transition-all cursor-pointer mr-2 hover:bg-blue-500 rounded-full w-6 mb-2 flex justify-center items-center"},[p(a,{size:"18px",color:"#fff"},{default:v((()=>[p(x(W))])),_:1})],8,R)])])])])),_:2},1024)))),128))]),o("div",X,[p(B,{"page-size":ye.value.per_page,onSizeChange:l[1]||(l[1]=e=>Ce("size",e)),onCurrentChange:l[2]||(l[2]=e=>Ce("page",e)),"page-sizes":[15,19,29,49],layout:"sizes,total,prev,pager,jumper",total:ye.value.total},null,8,["page-size","total"])])])),[[Be,be.value]])]),p(Oe,{modelValue:ne.value,"onUpdate:modelValue":l[9]||(l[9]=e=>ne.value=e),title:"添加背景壁纸",width:"700"},{default:v((()=>[p(Ue,{modelValue:ve.value,"onUpdate:modelValue":l[8]||(l[8]=e=>ve.value=e),"label-position":"top"},{default:v((()=>[p(pe,{label:"壁纸类型"},{default:v((()=>[p(ce,{disabled:ve.value.id>0||""!==ve.value.url,modelValue:ve.value.mime,"onUpdate:modelValue":l[3]||(l[3]=e=>ve.value.mime=e),placeholder:"请选择壁纸类型",class:"w-full"},{default:v((()=>[p(oe,{label:"图片壁纸",value:0}),p(oe,{label:"视频壁纸",value:1})])),_:1},8,["disabled","modelValue"])])),_:1}),0===ve.value.mime?(s(),b(pe,{key:0,label:"壁纸高清原图（3mb）"},{default:v((()=>[o("div",$,[ve.value.url?(s(),u("img",{key:0,src:ve.value.url,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,ee)):U("",!0),p(We,{modelValue:ve.value.url,"onUpdate:modelValue":l[4]||(l[4]=e=>ve.value.url=e),disabled:ve.value.id>0,placeholder:"请上传横屏的壁纸高清文件或网络链接地址"},{append:v((()=>[p(he,{class:"upload-demo","show-file-list":!1,"on-success":we,action:x(O)+x(re).state.site.upload},{default:v((()=>[p(g,{disabled:ve.value.id>0,type:"primary"},{default:v((()=>[C("上传")])),_:1},8,["disabled"])])),_:1},8,["action"])])),_:1},8,["modelValue","disabled"])]),le])),_:1})):U("",!0),1===ve.value.mime?(s(),b(pe,{key:1,label:"动态壁纸视频文件（mp4格式必须带后缀.mp4）（文件尺寸必须小于5mb）"},{default:v((()=>[o("div",ae,[ve.value.url?(s(),u("video",{key:0,autoplay:"",muted:"",loop:"",src:ve.value.url,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,te)):U("",!0),p(We,{modelValue:ve.value.url,"onUpdate:modelValue":l[5]||(l[5]=e=>ve.value.url=e),disabled:ve.value.id>0,placeholder:"请上传横屏的壁纸高清视频文件或网络链接地址,动态壁纸文件推荐使用告诉cdn的外链"},{append:v((()=>[p(he,{class:"upload-demo","show-file-list":!1,"on-success":we,action:x(O)+"/api/AdminUpload"},{default:v((()=>[p(g,{disabled:ve.value.id>0,type:"primary"},{default:v((()=>[C("上传")])),_:1},8,["disabled"])])),_:1},8,["action"])])),_:1},8,["modelValue","disabled"])]),de])),_:1})):U("",!0),p(pe,{label:"壁纸压缩封面"},{default:v((()=>[o("div",se,[ve.value.cover?(s(),u("img",{key:0,src:ve.value.cover,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,ue)):U("",!0),p(We,{modelValue:ve.value.cover,"onUpdate:modelValue":l[6]||(l[6]=e=>ve.value.cover=e),disabled:ve.value.id>0,placeholder:"请上传横屏封面文件或网络链接地址"},{append:v((()=>[p(he,{class:"upload-demo","show-file-list":!1,"on-success":ke,action:x(O)+x(re).state.site.upload},{default:v((()=>[p(g,{disabled:ve.value.id>0,type:"primary"},{default:v((()=>[C("上传")])),_:1},8,["disabled"])])),_:1},8,["action"])])),_:1},8,["modelValue","disabled"])]),ie])),_:1}),p(pe,{label:"分类"},{default:v((()=>[p(ce,{modelValue:ve.value.folder,"onUpdate:modelValue":l[7]||(l[7]=e=>ve.value.folder=e),placeholder:"分类选择可多选",class:"w-full"},{default:v((()=>[(s(!0),u(r,null,n(me.value,(e=>(s(),b(oe,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),p(g,{type:"primary",class:"w-full",onClick:Ve},{default:v((()=>[C("保存")])),_:1})])),_:1},8,["modelValue"])])}}};export{oe as default};
