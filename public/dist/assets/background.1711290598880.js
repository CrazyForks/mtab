import{u as e,r as l,a,b as t,G as d,c as s,d as o,i as u,e as r,F as i,f as n,v as c,k as p,h as v,Z as f,U as m,J as g,g as h,n as b,t as y,j as x,af as _,l as w,Y as k,ae as V,T as j,C,ag as z,ah as W,m as U,a3 as O}from"./index.1711290598880.js";import{S as F}from"./sortable.esm.1711290598880.js";const B={id:"backgroundManager",class:"rounded-lg overflow-hidden flex flex-wrap gap-2"},T={class:"flex flex-col bg-white w-52 px-2 py-4 rounded-lg h-full"},E={class:"h-full relative overflow-y-scroll leftScrollBackground"},M={class:"space-y-1 mb-4",id:"list"},S=["onClick","data-id"],I={class:"flex items-center"},A={class:"flex items-center gap-2"},D={class:"sticky bottom-0 flex justify-center"},G={class:"flex-1 relative overflow-y-scroll h-full"},J={class:"bg-white overflow-scroll relative flex-1 rounded-lg p-4"},Y={class:"grid grid-cols-4 gap-4",style:{"grid-auto-rows":"max-content"}},Z={style:{"aspect-ratio":"16 / 9",background:"linear-gradient(to right bottom, #ff4f00, #ff9068, #fdbc45, #ff9068, #ff4f00)"},class:"relative rounded-lg cursor-pointer"},q=r("div",{class:"el-upload__text"}," 点击这里上传您的背景资源 ",-1),H={style:{"aspect-ratio":"16 / 9"},class:"relative"},K=["src"],L={class:"absolute rounded-lg opacity-0 transition-all hover:opacity-100 inset-0 w-full h-full flex justify-center items-center",style:{"background-color":"rgba(0, 0, 0, 0.178)"}},N=["onClick"],P={class:"absolute z-10 right-0 bottom-0 w-full h-8 flex justify-end"},Q={class:"transition-all mr-4 cursor-pointer mr-2 hover:bg-blue-500 rounded-full w-6 mb-2 flex justify-center items-center"},R=["href"],X={class:"flex justify-center mt-8 mb-6"},$={style:{display:"flex","align-items":"center",width:"100%"}},ee=["src"],le=r("div",{class:"text-xs text-red-400 mt-1"},"建议文件尺寸不要大于5MB，过大请压缩后上传，推荐使用图床减轻服务器带宽压力",-1),ae={style:{display:"flex","align-items":"center",width:"100%"}},te=["src"],de=r("div",{class:"text-xs text-red-400 mt-1"},"图片尺寸宽度控制在300px左右或(文件大小在100kb左右)，推荐使用图床减轻服务器带宽压力",-1),se={__name:"background",setup(se){const oe=e(),ue=l(!1);let re=null;const ie={id:"",type:0,mime:"0",cover:"",folder:0,url:"",name:""},ne=l(Object.assign({},ie)),ce=l(0),pe=l([]),ve=l(!0),fe=l(!0),me={data:[],current_page:1,per_page:19},ge=l(Object.assign({},me)),he=e=>{ce.value=e.id,ge.value=Object.assign({},me),we()},be=()=>{ne.value=Object.assign({},ie),ne.value.folder=ce.value,ue.value=!0},ye=e=>{1===e.code&&(ne.value.url=e.data.url)},xe=e=>{1===e.code&&(ne.value.cover=e.data.url)},_e=async()=>{if(ne.value.folder&&ne.value.cover&&ne.value.url){1===(await m({url:"/Wallpaper/addWallpaper",method:"post",data:ne.value})).code&&(we(),ue.value=!1)}},we=()=>{fe.value=!0,m({url:"/Wallpaper/getFolderWallpaper",method:"post",data:{id:ce.value,limit:ge.value.per_page,page:ge.value.current_page}}).then((e=>{1===e.code&&(ge.value=e.data)})).finally((e=>{fe.value=!1}))},ke=(e,l)=>{"size"==e&&(ge.value.per_page=l),"page"==e&&(ge.value.current_page=l),we()},Ve=e=>{let l="",a="";"add"!==e&&(l=e.id,a=e.name),f.prompt("请输入壁纸分类名称","编辑文件夹",{confirmButtonText:"提交",cancelButtonText:"取消",inputValue:a,inputValidator:e=>""!==e&&null!==e,inputErrorMessage:"请输入分类名称"}).then((({value:e})=>{ve.value=!0,m({url:"/Wallpaper/editFolder",method:"post",data:{id:l,name:e}}).then((e=>{1===e.code&&(pe.value=e.data)})).finally((e=>{ve.value=!1}))})).catch((()=>{g.warning("已取消操作")}))};return m({url:"/Wallpaper/getFolder"}).then((e=>{1===e.code&&(pe.value=e.data,pe.value.length>0&&he(pe.value[0])),ve.value=!1})),a((()=>{let e=document.getElementById("list");if(e){const l={animation:200,delay:500,delayOnTouchOnly:!0,draggable:".item",onUpdate:function(e){let l=re.toArray(),a=[];l.forEach(((e,l)=>{a.push({id:parseInt(e),sort:l})})),m({url:"/Wallpaper/sortFolder",method:"post",data:a}).then((e=>{e.code}))}};re=F.create(e,l)}})),(e,l)=>{const a=t("el-icon"),g=t("el-button"),F=t("el-pagination"),se=t("el-option"),re=t("el-select"),ie=t("el-form-item"),me=t("el-upload"),je=t("el-input"),Ce=t("el-form"),ze=t("el-dialog"),We=d("loading");return s(),o("div",B,[u((s(),o("div",T,[r("div",E,[u(r("div",M,[(s(!0),o(i,null,n(pe.value,(e=>(s(),h(j,{key:e.id},{default:v((()=>[r("div",{onClick:l=>he(e),"data-id":null==e?void 0:e.id,class:b(["relative item px-4 py-1.5 text-sm rounded-sm cursor-pointer flex overflow-hidden justify-between items-center",{"bg-slate-200 text-blue-400":ce.value==e.id}])},[r("div",I,[r("span",null,y(e.name),1)]),r("div",A,[p(a,{class:"hover:text-blue-600",onClick:w((l=>Ve(e)),["stop"])},{default:v((()=>[p(x(_))])),_:2},1032,["onClick"]),p(a,{class:"hover:text-blue-600",onClick:w((l=>(async e=>{try{await f.confirm("是否删除当前壁纸分类，删除后该目录下的壁纸将一并删除！","删除警告"),await f.confirm("您正在进行危险操作，您是否知晓当前正在删除的分类","二次确认")}catch(l){return!1}ve.value=!0,m({url:"/Wallpaper/DelFolder",method:"post",data:{id:e.id}}).then((e=>{1===e.code&&(pe.value=e.data)})).finally((l=>{ve.value=!1,e.id==ce.value&&pe.value.length>0&&he(pe.value[0])}))})(e)),["stop"])},{default:v((()=>[p(x(k))])),_:2},1032,["onClick"]),p(a,{class:"cursor-move"},{default:v((()=>[p(x(V))])),_:1})])],10,S)])),_:2},1024)))),128))],512),[[c,pe.value.length]]),r("div",D,[p(g,{class:"w-11/12",type:"primary",onClick:l[0]||(l[0]=e=>Ve("add"))},{default:v((()=>[C("创建分类")])),_:1})])])])),[[We,ve.value]]),r("div",G,[u((s(),o("div",J,[r("div",Y,[r("div",Z,[r("div",{onClick:be,class:"upload-demo flex h-full flex-col justify-center items-center text-white"},[p(a,{size:"50px",class:"el-icon--upload"},{default:v((()=>[p(x(z))])),_:1}),q])]),(s(!0),o(i,null,n(ge.value.data,(e=>(s(),h(j,{key:e.id},{default:v((()=>[r("div",H,[r("img",{class:"rounded-lg object-cover w-full h-full bg-gray-200",src:e.cover},null,8,K),r("div",L,[r("div",{onClick:l=>(e=>{ne.value=Object.assign({},e),ue.value=!0})(e),class:"transition-all cursor-pointer bg-black bg-opacity-40 hover:opacity-100 hover:bg-red-500 rounded-full flex justify-center items-center w-10 h-10"},[p(a,{size:"28px",color:"#fff"},{default:v((()=>[p(x(_))])),_:1})],8,N),r("div",P,[r("div",Q,[p(a,{onClick:l=>(async e=>{try{await f.confirm("是否删除当前选中壁纸？","删除警告")}catch(l){return!1}1===(await m({url:"/Wallpaper/deleteWallpaper",method:"post",data:{id:e.id}})).code&&(we(),ue.value=!1)})(e),size:"18px",color:"#fff"},{default:v((()=>[p(x(k))])),_:2},1032,["onClick"])]),r("a",{target:"_blank",download:"background",href:e.url,class:"transition-all cursor-pointer mr-2 hover:bg-blue-500 rounded-full w-6 mb-2 flex justify-center items-center"},[p(a,{size:"18px",color:"#fff"},{default:v((()=>[p(x(W))])),_:1})],8,R)])])])])),_:2},1024)))),128))]),r("div",X,[p(F,{"page-size":ge.value.per_page,onSizeChange:l[1]||(l[1]=e=>ke("size",e)),onCurrentChange:l[2]||(l[2]=e=>ke("page",e)),"page-sizes":[15,19,29,49],layout:"sizes,total,prev,pager,jumper",total:ge.value.total},null,8,["page-size","total"])])])),[[We,fe.value]])]),p(ze,{modelValue:ue.value,"onUpdate:modelValue":l[8]||(l[8]=e=>ue.value=e),title:"添加背景壁纸",width:"700"},{default:v((()=>[p(Ce,{modelValue:ne.value,"onUpdate:modelValue":l[7]||(l[7]=e=>ne.value=e),"label-position":"top"},{default:v((()=>[p(ie,{label:"壁纸类型"},{default:v((()=>[p(re,{modelValue:ne.value.type,"onUpdate:modelValue":l[3]||(l[3]=e=>ne.value.type=e),placeholder:"请选择壁纸类型",class:"w-full"},{default:v((()=>[p(se,{label:"图片壁纸",value:0}),p(se,{label:"视频壁纸（暂未开放）",disabled:"",value:1})])),_:1},8,["modelValue"])])),_:1}),p(ie,{label:"壁纸高清原图"},{default:v((()=>[r("div",$,[ne.value.url?(s(),o("img",{key:0,src:ne.value.url,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,ee)):U("",!0),p(je,{modelValue:ne.value.url,"onUpdate:modelValue":l[4]||(l[4]=e=>ne.value.url=e),disabled:ne.value.id>0,placeholder:"请上传横屏的壁纸高清文件或网络链接地址"},{append:v((()=>[p(me,{class:"upload-demo","show-file-list":!1,"on-success":ye,action:x(O)+x(oe).state.site.upload},{default:v((()=>[p(g,{disabled:ne.value.id>0,type:"primary"},{default:v((()=>[C("上传")])),_:1},8,["disabled"])])),_:1},8,["action"])])),_:1},8,["modelValue","disabled"])]),le])),_:1}),p(ie,{label:"壁纸压缩封面"},{default:v((()=>[r("div",ae,[ne.value.cover?(s(),o("img",{key:0,src:ne.value.cover,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,te)):U("",!0),p(je,{modelValue:ne.value.cover,"onUpdate:modelValue":l[5]||(l[5]=e=>ne.value.cover=e),disabled:ne.value.id>0,placeholder:"请上传横屏封面文件或网络链接地址"},{append:v((()=>[p(me,{class:"upload-demo","show-file-list":!1,"on-success":xe,action:x(O)+x(oe).state.site.upload},{default:v((()=>[p(g,{disabled:ne.value.id>0,type:"primary"},{default:v((()=>[C("上传")])),_:1},8,["disabled"])])),_:1},8,["action"])])),_:1},8,["modelValue","disabled"])]),de])),_:1}),p(ie,{label:"分类"},{default:v((()=>[p(re,{modelValue:ne.value.folder,"onUpdate:modelValue":l[6]||(l[6]=e=>ne.value.folder=e),placeholder:"分类选择可多选",class:"w-full"},{default:v((()=>[(s(!0),o(i,null,n(pe.value,(e=>(s(),h(se,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),p(g,{type:"primary",class:"w-full",onClick:_e},{default:v((()=>[C("保存")])),_:1})])),_:1},8,["modelValue"])])}}};export{se as default};
