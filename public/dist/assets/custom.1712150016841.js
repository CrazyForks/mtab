import{K as l,r as a,u as e,E as t,o as u,b as s,c as o,d as r,e as i,k as d,h as n,C as c,j as v,a3 as p,i as m,v as g,av as x,p as b,m as f,F as h,f as w,V as y,J as k}from"./index.1712150016841.js";const _={class:"customBox pb-6"},V={class:"flex gap-4 w-full"},C={class:"flex gap-4 w-full"},j={class:"col-span-2 h-16 flex"},z={class:"iconsel absolute z-10"},U=["src"],E={class:"iconsel absolute z-10"},G=["src"],I={class:"bgColorPicker"},L=["onClick"],O={key:0,class:"touming"},R={key:0,style:{"font-size":"20px",color:"#ff0000",inset:"-5px 3px",position:"relative"}},P={key:0,style:{"font-size":"20px",color:"#d9d9d9",inset:"-5px 3px",position:"relative"}},S=i("span",{class:"ml-6 text-xs text-red-500"},"内嵌窗口形式打开，存在第三方兼容问题，请酌情使用",-1),B={class:"w-full xs:pl-20 mt-10 flex"},F={__name:"custom",props:{data:{type:Object}},setup(F){var J;const K=F,M={userid:l.get("user_id"),token:l.get("token","")},W=window.innerWidth,q=["rgba(0,0,0,0)","#fff","rgb(22, 129, 255)","rgb(251, 190, 35)","rgb(252, 69, 72)","rgb(75, 60, 54)","rgb(125, 172, 104)","rgb(2, 51, 115)","rgb(200, 172, 112)","rgb(55, 33, 40)","rgb(5, 64, 146)"],A=a(!1),D=a(1),H=l=>{D.value=l},N=a(!1),Q=e(),T={id:"",name:"",src:"",url:"",size:"1x1",type:"icon",sort:99999,app:0,bgColor:null,pageGroup:""},X=a(Object.assign({},T));(null==(J=K.data)?void 0:J.id)&&(X.value=K.data);const Y=async()=>{var l;N.value=!0;try{const l=await y({url:"/LinkStore/getIcon",method:"post",data:{url:X.value.url}});if(1===l.code)return X.value.src=l.data.src,X.value.name=l.data.name,void(N.value=!1)}catch(a){}try{const a=await y({url:"/api/getIcon",method:"post",data:{url:X.value.url}});1===a.code?(X.value.src=a.data.src,a.data.name&&(X.value.name=null==(l=a.data)?void 0:l.name.substring(0,20))):k.error(a.msg)}catch(a){console.error("Error fetching data:",a),k.error("获取网站数据失败,请手动设置")}N.value=!1},Z=l=>{1===l.code?X.value.src=l.data.url:k.warning(l.msg)},$=async()=>{if(""===X.value.name||""===X.value.url)return k.warning("请设置标签信息");if(N.value=!0,"tab"===X.value.url.slice(0,3)||1===X.value.app||"http"!==X.value.url.slice(0,4)&&(X.value.url="http://"+X.value.url),2===D.value)try{const l=await y({url:"/api/getIcon",method:"post",data:{avatar:X.value.name}});1===l.code&&(X.value.src=l.data.src)}catch(l){}""===X.value.id?(X.value.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(l){var a=16*Math.random()|0;return("x"==l?a:3&a|8).toString(16)})),X.value.pageGroup=Q.state.pageGroup,Q.state.link.push(X.value),Q.commit("updateLink")):(Q.commit("setLink",X.value),t.emit("refreshGroup")),N.value=!1,t.emit("closePlugin"),A.value=!1};return t.on("linkEdit",((l={})=>{l&&(X.value=Object.assign({},T)),A.value=!0})),u((()=>{t.off("linkEdit".open)})),(l,a)=>{const e=s("el-input"),t=s("el-button"),u=s("el-form-item"),y=s("el-upload"),k=s("el-icon"),F=s("el-color-picker"),J=s("el-switch"),K=s("el-form");return o(),r("div",_,[i("div",null,[d(K,{"label-position":v(W)<500?"top":"right","label-width":"80px",class:"w-full mt-4"},{default:n((()=>[d(u,{label:"标签网址"},{default:n((()=>[i("div",V,[d(e,{class:"input_div w-full",modelValue:X.value.url,"onUpdate:modelValue":a[0]||(a[0]=l=>X.value.url=l),"show-word-limit":"",maxlength:"255",placeholder:"请输入带http开头的网址"},null,8,["modelValue"]),d(t,{type:"primary",onClick:Y,loading:N.value},{default:n((()=>[c("获取图标")])),_:1},8,["loading"])])])),_:1}),d(u,{label:"标签名称"},{default:n((()=>[d(e,{maxlength:"100",class:"input_div","show-word-limit":"",modelValue:X.value.name,"onUpdate:modelValue":a[1]||(a[1]=l=>X.value.name=l),placeholder:"标签名称"},null,8,["modelValue"])])),_:1}),d(u,{label:"标签简介"},{default:n((()=>[d(e,{class:"input_div",maxlength:"200","show-word-limit":"",type:"textarea",rows:"2",modelValue:X.value.tips,"onUpdate:modelValue":a[2]||(a[2]=l=>X.value.tips=l),placeholder:"简单介绍标签（非必填）"},null,8,["modelValue"])])),_:1}),d(u,{label:"标签图标"},{default:n((()=>[i("div",C,[d(e,{class:"input_div",modelValue:X.value.src,"onUpdate:modelValue":a[3]||(a[3]=l=>X.value.src=l),placeholder:"请上传或粘贴标签图标地址,支持png,jpg,ico,svg,webp格式"},null,8,["modelValue"]),d(y,{class:"upload-demo","show-file-list":!1,"on-success":Z,headers:M,action:v(p)+v(Q).state.site.upload},{default:n((()=>[d(t,{type:"danger"},{default:n((()=>[c("手动上传")])),_:1})])),_:1},8,["action"])])])),_:1}),d(u,{label:"选择图标"},{default:n((()=>[i("div",j,[X.value.src?(o(),r("div",{key:0,class:"relative",onClick:a[4]||(a[4]=l=>H(1))},[m(i("div",z,[d(k,null,{default:n((()=>[d(v(x))])),_:1})],512),[[g,1===D.value]]),i("img",{src:X.value.src,class:"mr-3",style:b({width:"60px",height:"60px",backgroundColor:X.value.bgColor,borderRadius:"var(--iconRadius)"})},null,12,U)])):f("",!0),i("div",{class:"relative",onClick:a[5]||(a[5]=l=>H(2))},[m(i("div",E,[d(k,null,{default:n((()=>[d(v(x))])),_:1})],512),[[g,2===D.value]]),i("img",{src:v(p)+"/api/renderIco?seed="+X.value.name,class:"mr-3 bg-slate-100",style:{width:"60px",height:"60px","border-radius":"var(--iconRadius)"}},null,8,G)])])])),_:1}),d(u,{label:"背景颜色"},{default:n((()=>[i("ul",I,[(o(),r(h,null,w(q,(l=>i("li",{onClick:a=>{return e=l,void(X.value.bgColor=e);var e}},["rgba(0,0,0,0)"===l?(o(),r("div",O,[l===X.value.bgColor?(o(),r("b",R,"√")):f("",!0)])):(o(),r("div",{key:1,style:b({backgroundColor:l})},[l===X.value.bgColor?(o(),r("b",P,"√")):f("",!0)],4))],8,L))),64)),d(F,{"show-alpha":"",modelValue:X.value.bgColor,"onUpdate:modelValue":a[6]||(a[6]=l=>X.value.bgColor=l)},null,8,["modelValue"])])])),_:1}),d(u,{label:"内嵌窗口"},{default:n((()=>[d(J,{"active-value":1,"inactive-value":0,modelValue:X.value.app,"onUpdate:modelValue":a[7]||(a[7]=l=>X.value.app=l)},null,8,["modelValue"]),S])),_:1})])),_:1},8,["label-position"]),i("div",B,[d(t,{type:"primary",size:"large",class:"w-full",onClick:$},{default:n((()=>[c("保存")])),_:1})])])])}}};export{F as default};
