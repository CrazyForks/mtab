import{r as e,u as l,b as a,c as t,d as o,e as u,k as d,h as r,S as n,F as i,f as s,g as p,X as c,t as m,m as v,j as h,Q as f,a6 as g,Y as w}from"./index.1701946211972.js";const b={class:"linkstoreAdmin"},V={class:"p-4 bg-white rounded-lg overflow-hidden flex flex-wrap gap-4"},_={class:"ml-auto"},y={class:"mt-4 p-4 bg-white rounded-lg overflow-hidden w-full"},x=["src"],k={style:{display:"flex","align-items":"center",width:"100%"}},C=["src"],U={class:"folderManager"},j={class:"flex w-full mt-6"},O={class:"flex mt-6"},S={__name:"linkstore",setup(S){const z={id:"",name:"",sort:""},A=e(Object.assign({},z)),F=e([]),L=()=>{n({url:"/linkStore/getFolder"}).then((e=>{F.value=e.data}))};L();const D=e({name:"",area:""}),I=(e="")=>{e=e.split(",");const l=[];return e.forEach((e=>{const a=F.value.find((l=>l.id.toString()===e));a&&l.push(a.name)})),l.join(",")},E=e(!1),M=e(!1),P=l(),W=e(!1),G=e({}),Q=()=>{G.value={},W.value=!0},R=()=>{M.value=!0},X=(e={})=>{A.value=0===e?Object.assign({},z):Object.assign({},e),E.value=!0},Y=()=>{n({url:"/linkStore/createFolder",method:"post",data:{type:"edit",info:A.value}}).then((e=>{g.success(e.msg),1===e.code&&(L(),E.value=!1)}))},$=e=>{1===e.code&&(G.value.src=e.data.url)};let q=e(!1);const B=async()=>{q.value=!0;try{const e=await n({url:"/api/getIcon",method:"post",data:{url:G.value.url}});1===e.code?(G.value.src=e.data.src,G.value.tips=e.data.name.substring(0,30)):g.error("获取网站数据失败,请手动设置")}catch(e){console.error("Error fetching data:",e),g.error("获取网站数据失败,请手动设置")}q.value=!1},H=()=>{let e=Object.assign({},G.value);e.area=e.area.join(","),n({url:"/linkStore/add",method:"post",data:{form:e}}).then((e=>{g.success(e.msg),W.value=!1,N()}))},J=e({current_page:1,per_page:15,total:0,refresh(e){J.value.current_page=e,N()}}),K=e([]),N=()=>{n({url:"/LinkStore/ListManager",method:"post",data:{search:D.value,page:J.value.current_page,limit:J.value.per_page}}).then((e=>{K.value=e.data.data,Object.assign(J.value,e.data)}))};return N(),(e,l)=>{const S=a("el-input"),z=a("el-option"),q=a("el-select"),T=a("el-button"),Z=a("el-table-column"),ee=a("el-tag"),le=a("el-table"),ae=a("el-pagination"),te=a("el-form-item"),oe=a("el-upload"),ue=a("el-switch"),de=a("el-input-number"),re=a("el-form"),ne=a("el-dialog");return t(),o("div",b,[u("div",V,[d(S,{modelValue:D.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>D.value.name=e),style:{width:"200px"},placeholder:"名称搜索",clearable:""},null,8,["modelValue"]),d(q,{modelValue:D.value.area,"onUpdate:modelValue":l[1]||(l[1]=e=>D.value.area=e),style:{width:"200px"},placeholder:"分类搜索",clearable:""},{default:r((()=>[(t(!0),o(i,null,s(F.value,(e=>(t(),p(z,{value:e.id,label:e.name},null,8,["value","label"])))),256))])),_:1},8,["modelValue"]),d(T,{onClick:N,type:"primary"},{default:r((()=>[c("搜索")])),_:1}),d(T,{type:"danger",onClick:Q},{default:r((()=>[c("添加新标签")])),_:1}),u("div",_,[d(T,{type:"info",onClick:R},{default:r((()=>[c("标签分类管理")])),_:1})])]),u("div",y,[d(le,{height:"calc(100vh - 203px)",stripe:"",data:K.value},{default:r((()=>[d(Z,{fixed:"left",prop:"id",label:"ID",align:"center",width:"100"}),d(Z,{prop:"name",label:"网站名称",align:"center",width:"200"}),d(Z,{prop:"src",label:"LOGO",align:"center",width:"80"},{default:r((e=>[u("img",{src:e.row.src,class:"logoiconRadius",alt:"Logo",style:{"max-width":"100%","max-height":"100%"}},null,8,x)])),_:1}),d(Z,{prop:"url","show-overflow-tooltip":"",label:"域名链接",align:"center",width:"260"}),d(Z,{prop:"domain",label:"Domain",align:"center",width:"260"}),d(Z,{prop:"app",label:"是否WebApp",align:"center",width:"140"},{default:r((e=>[1===e.row.app?(t(),p(ee,{key:0},{default:r((()=>[c("WebApp")])),_:1})):(t(),p(ee,{key:1,type:"info"},{default:r((()=>[c("标签")])),_:1}))])),_:1}),d(Z,{prop:"area",width:"200px","show-overflow-tooltip":"",label:"分类",align:"center"},{default:r((e=>[c(m(I(e.row.area)),1)])),_:1}),d(Z,{prop:"tips",label:"简介",align:"center",width:"300"}),d(Z,{prop:"install_num",label:"安装量(次)",align:"center",width:"100"}),d(Z,{prop:"create_time",label:"创建时间",align:"center",width:"200"}),d(Z,{fixed:"right",label:"操作",align:"center",width:"150"},{default:r((e=>[d(T,{type:"primary",size:"small",onClick:l=>(e=>{G.value=Object.assign({},e);const l=e.area.split(",");l.length>0&&""!==l[0]?G.value.area=l:G.value.area=[],W.value=!0})(e.row)},{default:r((()=>[c("操作")])),_:2},1032,["onClick"]),d(T,{type:"danger",size:"small",onClick:l=>{return a=e.row.id,void w.confirm("是否批量删除","删除提示").then((e=>{n({url:"/linkStore/del",method:"post",data:{ids:[a]}}).then((e=>{g.success(e.msg),N()}))})).catch();var a}},{default:r((()=>[c("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d(ae,{onCurrentChange:J.value.refresh,"page-size":15,class:"mt-6",layout:"total,prev, pager, next",total:J.value.total},null,8,["onCurrentChange","total"])]),d(ne,{modelValue:W.value,"onUpdate:modelValue":l[12]||(l[12]=e=>W.value=e),title:"编辑标签",size:"400px","close-on-click-modal":!1,top:"5vh"},{default:r((()=>[d(re,{modelValue:G.value,"onUpdate:modelValue":l[11]||(l[11]=e=>G.value=e),"label-position":"top"},{default:r((()=>[d(te,{label:"名称"},{default:r((()=>[d(S,{modelValue:G.value.name,"onUpdate:modelValue":l[2]||(l[2]=e=>G.value.name=e),"show-word-limit":"",maxlength:"50",placeholder:"请输入网站title或名称"},null,8,["modelValue"])])),_:1}),d(te,{label:"网址"},{default:r((()=>[d(S,{modelValue:G.value.url,"onUpdate:modelValue":l[3]||(l[3]=e=>G.value.url=e),"show-word-limit":"",maxlength:"251",placeholder:"请输入网址,请携带http协议"},null,8,["modelValue"])])),_:1}),d(te,{label:"logo"},{default:r((()=>[u("div",k,[G.value.src?(t(),o("img",{key:0,src:G.value.src,style:{width:"30px",height:"30px","margin-right":"10px","border-radius":"3px"}},null,8,C)):v("",!0),d(S,{modelValue:G.value.src,"onUpdate:modelValue":l[4]||(l[4]=e=>G.value.src=e),placeholder:"标签图标地址(120x120)px尺寸最佳"},{append:r((()=>[d(oe,{class:"upload-demo","show-file-list":!1,"on-success":$,action:h(f)+h(P).state.site.upload},{default:r((()=>[d(T,{type:"primary"},{default:r((()=>[c("上传")])),_:1})])),_:1},8,["action"])])),_:1},8,["modelValue"]),d(T,{type:"primary",style:{width:"100px","margin-left":"15px"},onClick:B},{default:r((()=>[c("抓取图标")])),_:1})])])),_:1}),d(te,{label:"域名"},{default:r((()=>[d(S,{modelValue:G.value.domain,"onUpdate:modelValue":l[5]||(l[5]=e=>G.value.domain=e),"show-word-limit":"",maxlength:"251",placeholder:"请输入域名多个可以用,隔开。域名不要携带http协议"},null,8,["modelValue"])])),_:1}),d(te,{label:"分类"},{default:r((()=>[d(q,{modelValue:G.value.area,"onUpdate:modelValue":l[6]||(l[6]=e=>G.value.area=e),multiple:!0,placeholder:"分类选择可多选",class:"w-full"},{default:r((()=>[(t(!0),o(i,null,s(F.value,(e=>(t(),p(z,{key:e.id,label:e.name,value:`${e.id}`},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(te,{label:"简介"},{default:r((()=>[d(S,{modelValue:G.value.tips,"onUpdate:modelValue":l[7]||(l[7]=e=>G.value.tips=e),placeholder:"请简单介绍一下建议30字符以内","show-word-limit":"",maxlength:"200"},null,8,["modelValue"])])),_:1}),d(te,{label:"是否网页APP"},{default:r((()=>[d(ue,{"active-value":1,"inactive-value":0,modelValue:G.value.app,"onUpdate:modelValue":l[8]||(l[8]=e=>G.value.app=e)},null,8,["modelValue"])])),_:1}),d(te,{label:"标签添加量（热度）"},{default:r((()=>[d(de,{modelValue:G.value.install_num,"onUpdate:modelValue":l[9]||(l[9]=e=>G.value.install_num=e),class:"w-full",placeholder:"数值越高排名越高"},null,8,["modelValue"])])),_:1}),d(te,{label:"排行"},{default:r((()=>[d(de,{modelValue:G.value.hot,"onUpdate:modelValue":l[10]||(l[10]=e=>G.value.hot=e),class:"w-full",placeholder:"数值越高排名越高"},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),d(T,{type:"primary",class:"w-full",onClick:H},{default:r((()=>[c("保存")])),_:1})])),_:1},8,["modelValue"]),d(ne,{modelValue:M.value,"onUpdate:modelValue":l[18]||(l[18]=e=>M.value=e),width:"1000px",title:"分类管理","close-on-click-modal":!1},{default:r((()=>[u("div",U,[d(le,{border:"",data:F.value,style:{width:"100%"},height:"450"},{default:r((()=>[d(Z,{prop:"id",fixed:"",label:"分类ID",width:"90",align:"center"}),d(Z,{prop:"name",label:"分类名称"}),d(Z,{prop:"sort",sortable:"",align:"center",width:"120",label:"分类排序"}),d(Z,{fixed:"right",label:"操作",align:"center",width:"150"},{default:r((e=>[d(T,{type:"success",size:"small",onClick:l=>X(e.row)},{default:r((()=>[c("修改")])),_:2},1032,["onClick"]),d(T,{type:"danger",size:"small",onClick:l=>{return a=e.row,void w.confirm("是否删除当前标签分类","危险警告").then((e=>{n({url:"/linkStore/createFolder",method:"post",data:{type:"del",id:a.id}}).then((e=>{g.success(e.msg),1===e.code&&(L(),E.value=!1)}))}));var a}},{default:r((()=>[c("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u("div",j,[d(T,{type:"primary",class:"m-auto w-1/5",onClick:l[13]||(l[13]=e=>X(0))},{default:r((()=>[c("新增")])),_:1})]),d(ne,{modelValue:E.value,"onUpdate:modelValue":l[17]||(l[17]=e=>E.value=e),width:"500px","align-center":"","append-to-body":"",title:"分类编辑"},{default:r((()=>[d(re,{modelValue:G.value,"onUpdate:modelValue":l[16]||(l[16]=e=>G.value=e),"label-position":"top"},{default:r((()=>[d(te,{label:"分类名称"},{default:r((()=>[d(S,{modelValue:A.value.name,"onUpdate:modelValue":l[14]||(l[14]=e=>A.value.name=e),"show-word-limit":"",maxlength:"50",placeholder:"请输入分类名称"},null,8,["modelValue"])])),_:1}),d(te,{label:"分类排序"},{default:r((()=>[d(de,{modelValue:A.value.sort,"onUpdate:modelValue":l[15]||(l[15]=e=>A.value.sort=e),class:"w-full",placeholder:"请输入展示排序（值越大越靠前）"},null,8,["modelValue"])])),_:1}),u("div",O,[d(T,{class:"m-auto w-2/5",type:"primary",onClick:Y},{default:r((()=>[c("保存")])),_:1})])])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])])}}};export{S as default};
